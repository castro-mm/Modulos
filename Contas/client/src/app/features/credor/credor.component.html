<div class="container-fluid">
    <app-breadcrumb/>
    <p-panel header="Filtros de Pesquisa" [toggleable]="true" [collapsed]="true" class="mb-4">
        <form [formGroup]="form" (submit)="listar()" #f>
            <p-divider class="mt-1" />
            <div class="row mt-2">
                <div class="col-4">
                    <label for="razaoSocial" class="mb-1">Razão Social:</label>
                    <input 
                        id="razaoSocial" 
                        formControlName="razaoSocial" 
                        pInputText 
                        fluid />
                </div>
            </div>
            <div class="row mt-2">
                <div class="col-2">
                    <label for="cnpj" class="mb-1">CNPJ:</label>
                    <input 
                        id="cnpj" 
                        formControlName="cnpj" 
                        pInputText 
                        mask="00.000.000/0000-00" 
                        [showMaskTyped]="true" 
                        [dropSpecialCharacters]="true"
                        [validation]="true"
                        fluid />
                        @if (form.get('cnpj')?.errors?.['invalidCnpj']) {
                            <p-message severity="error" size="small" variant="simple">O CNPJ deve seguir o formato válido.</p-message>
                        }    
                </div>
            </div>
            <div class="row mt-2">            
                <div class="col-4">
                    <label for="nomeFantasia" class="mb-1">Nome Fantasia:</label>
                    <input 
                        id="nomeFantasia" 
                        formControlName="nomeFantasia" 
                        pInputText 
                        fluid />
                </div>
            </div>
            <div class="row mt-2">            
                <div class="col-2">
                    <label for="segmentoDoCredorId" class="mb-1">Segmento do Credor:</label>
                    <p-select 
                        formControlName="segmentoDoCredorId" 
                        inputId="segmentoDoCredor" 
                        [options]="segmentoDoCredorOptions"
                        optionLabel="label" 
                        optionValue="value" 
                        appendTo="body"
                        placeholder="Selecione..."
                        fluid 
                        />
                </div>
            </div>
            <p-divider class="mt-3" />
            <div class="row mt-3">
                <div class="col-12 text-end mt-1">
                    <div class="col-12 text-end mt-1">
                        <p-button 
                            icon="pi pi-times" 
                            label="Limpar" 
                            severity="secondary" 
                            class="me-2" 
                            text 
                            (click)="f.reset()"/>
                        <p-button 
                            icon="pi pi-search" 
                            [loading]="isLoading" 
                            [label]="isLoading ? 'Executando...': 'Pesquisar'" 
                            severity="success" 
                            type="submit"
                            [disabled]="form.invalid || isLoading"
                            />
                    </div>
                </div>
            </div>
        </form>        
    </p-panel>    
    <app-table-list
        [cols]="columns"
        [rows]="10"
        [entityList]="entityList()"
        [modalSize]="modalSize"
        [globalFilterFields]="filterFields"
        [isLoading]="isLoading"
        [detailComponent]="detailComponent"
        (onListar)="listar()"
        (onExcluirVarios)="excluirVarios($event)"
        (onExcluir)="excluir($event)"
    />
</div>

